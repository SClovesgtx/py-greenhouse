Fri 09 Apr 2021 08:21:49 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 3 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get [32mPASSED[0m[32m               [ 33%][0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m[32m [ 66%][0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m[32m          [100%][0m

[32m============================== [32m[1m3 passed[0m[32m in 1.94s[0m[32m ===============================[0m
Fri 09 Apr 2021 08:47:07 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 3 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m3 passed[0m[32m in 2.45s[0m[32m ===============================[0m
Tue 13 Apr 2021 09:25:58 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 3 items                                                             [0m[1mcollected 3 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m3 passed[0m[32m in 7.55s[0m[32m ===============================[0m
Tue 13 Apr 2021 09:52:11 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 4 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [31mERROR[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

==================================== ERRORS ====================================
[31m[1m______________ ERROR at setup of test_data_splitting_train_ratio _______________[0m

    [37m@pytest[39;49;00m.fixture
    [94mdef[39;49;00m [92mdf_10_rows[39;49;00m():
    
>       [94mreturn[39;49;00m pd.DataFrame(
            {
                [33m"[39;49;00m[33ma[39;49;00m[33m"[39;49;00m: [[94m0[39;49;00m, [94m1[39;49;00m, [94m2[39;49;00m, [94m3[39;49;00m, [94m4[39;49;00m, [94m5[39;49;00m, [94m6[39;49;00m, [94m7[39;49;00m, [94m8[39;49;00m, [94m9[39;49;00m],
                [33m"[39;49;00m[33mb[39;49;00m[33m"[39;49;00m: [[33m'[39;49;00m[33ma[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mb[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mc[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33md[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33me[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mf[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mg[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mh[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mi[39;49;00m[33m'[39;49;00m, [33m'[39;49;00m[33mj[39;49;00m[33m'[39;49;00m],
            }
        )
[1m[31mE       NameError: name 'pd' is not defined[0m

[1m[31mtests/test_data_splitting.py[0m:8: NameError
=========================== short test summary info ============================
ERROR tests/test_data_splitting.py::test_data_splitting_train_ratio - NameErr...
[31m========================== [32m3 passed[0m, [31m[1m1 error[0m[31m in 3.29s[0m[31m ==========================[0m
Tue 13 Apr 2021 09:52:40 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 4 items                                                             [0m[1mcollected 4 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m4 passed[0m[32m in 3.19s[0m[32m ===============================[0m
Tue 13 Apr 2021 09:54:28 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 5 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_valid [32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m5 passed[0m[32m in 2.30s[0m[32m ===============================[0m
Tue 13 Apr 2021 09:54:55 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 6 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_valid [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_test [32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m6 passed[0m[32m in 2.36s[0m[32m ===============================[0m
Thu 15 Apr 2021 08:47:58 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 7 items                                                             [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    a  b
0  0  a
1  1  b
2  2  c
3  3  d
4  4  e
5  5  f
6  6  g
7  7  h
8  8  i
9  9  j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
>       [94massert[39;49;00m ~train.equals(valid)
[1m[31mE       NameError: name 'train' is not defined[0m

[1m[31mtests/test_data_splitting.py[0m:45: NameError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Nam...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 9.86s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:52:37 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    a  b
0  0  a
1  1  b
2  2  c
3  3  d
4  4  e
5  5  f
6  6  g
7  7  h
8  8  i
9  9  j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
        train, valid, test = data_splitting.split(
            df_10_rows, train_ratio=[94m0.7[39;49;00m, valid_ratio=[94m0.2[39;49;00m, test_ratio=[94m0.1[39;49;00m, seed=[94m0[39;49;00m
        )
    
>       check = train.join(valid, how=[33m'[39;49;00m[33mleft[39;49;00m[33m'[39;49;00m)

[1m[31mtests/test_data_splitting.py[0m:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8107: in join
    [94mreturn[39;49;00m [96mself[39;49;00m._join_compat(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8132: in _join_compat
    [94mreturn[39;49;00m merge(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:89: in merge
    [94mreturn[39;49;00m op.get_result()
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:686: in get_result
    llabels, rlabels = _items_overlap_with_suffix(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

left = Index(['a', 'b'], dtype='object')
right = Index(['a', 'b'], dtype='object'), suffixes = ('', '')

    [94mdef[39;49;00m [92m_items_overlap_with_suffix[39;49;00m(left: Index, right: Index, suffixes: Tuple[[96mstr[39;49;00m, [96mstr[39;49;00m]):
        [33m"""[39;49;00m
    [33m    Suffixes type validation.[39;49;00m
    [33m[39;49;00m
    [33m    If two indices overlap, add suffixes to overlapping entries.[39;49;00m
    [33m[39;49;00m
    [33m    If corresponding suffix is empty, the entry is simply converted to string.[39;49;00m
    [33m[39;49;00m
    [33m    """[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m is_list_like(suffixes, allow_sets=[94mFalse[39;49;00m):
            warnings.warn(
                [33mf[39;49;00m[33m"[39;49;00m[33mPassing [39;49;00m[33m'[39;49;00m[33msuffixes[39;49;00m[33m'[39;49;00m[33m as a [39;49;00m[33m{[39;49;00m[96mtype[39;49;00m(suffixes)[33m}[39;49;00m[33m, is not supported and may give [39;49;00m[33m"[39;49;00m
                [33m"[39;49;00m[33munexpected results. Provide [39;49;00m[33m'[39;49;00m[33msuffixes[39;49;00m[33m'[39;49;00m[33m as a tuple instead. In the [39;49;00m[33m"[39;49;00m
                [33m"[39;49;00m[33mfuture a [39;49;00m[33m'[39;49;00m[33mTypeError[39;49;00m[33m'[39;49;00m[33m will be raised.[39;49;00m[33m"[39;49;00m,
                [96mFutureWarning[39;49;00m,
                stacklevel=[94m4[39;49;00m,
            )
    
        to_rename = left.intersection(right)
        [94mif[39;49;00m [96mlen[39;49;00m(to_rename) == [94m0[39;49;00m:
            [94mreturn[39;49;00m left, right
    
        lsuffix, rsuffix = suffixes
    
        [94mif[39;49;00m [95mnot[39;49;00m lsuffix [95mand[39;49;00m [95mnot[39;49;00m rsuffix:
>           [94mraise[39;49;00m [96mValueError[39;49;00m([33mf[39;49;00m[33m"[39;49;00m[33mcolumns overlap but no suffix specified: [39;49;00m[33m{[39;49;00mto_rename[33m}[39;49;00m[33m"[39;49;00m)
[1m[31mE           ValueError: columns overlap but no suffix specified: Index(['a', 'b'], dtype='object')[0m

[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:2178: ValueError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Val...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 4.08s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:53:59 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    col_1 col_2
0      0     a
1      1     b
2      2     c
3      3     d
4      4     e
5      5     f
6      6     g
7      7     h
8      8     i
9      9     j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
        train, valid, test = data_splitting.split(
            df_10_rows, train_ratio=[94m0.7[39;49;00m, valid_ratio=[94m0.2[39;49;00m, test_ratio=[94m0.1[39;49;00m, seed=[94m0[39;49;00m
        )
    
>       check = train.join(valid, how=[33m"[39;49;00m[33mleft[39;49;00m[33m"[39;49;00m, on=[[33m"[39;49;00m[33mcol_1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mcol_2[39;49;00m[33m"[39;49;00m])

[1m[31mtests/test_data_splitting.py[0m:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8107: in join
    [94mreturn[39;49;00m [96mself[39;49;00m._join_compat(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8132: in _join_compat
    [94mreturn[39;49;00m merge(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:74: in merge
    op = _MergeOperation(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:650: in __init__
    [96mself[39;49;00m._validate_specification()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <pandas.core.reshape.merge._MergeOperation object at 0x7f38a0de3b80>

    [94mdef[39;49;00m [92m_validate_specification[39;49;00m([96mself[39;49;00m):
        [94mif[39;49;00m [96mself[39;49;00m.how == [33m"[39;49;00m[33mcross[39;49;00m[33m"[39;49;00m:
            [94mif[39;49;00m (
                [96mself[39;49;00m.left_index
                [95mor[39;49;00m [96mself[39;49;00m.right_index
                [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
            ):
                [94mraise[39;49;00m MergeError(
                    [33m"[39;49;00m[33mCan not pass on, right_on, left_on or set right_index=True or [39;49;00m[33m"[39;49;00m
                    [33m"[39;49;00m[33mleft_index=True[39;49;00m[33m"[39;49;00m
                )
            [94mreturn[39;49;00m
        [90m# Hm, any way to make this logic less complicated??[39;49;00m
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
    
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mand[39;49;00m [96mself[39;49;00m.right_index:
                [96mself[39;49;00m.left_on, [96mself[39;49;00m.right_on = (), ()
            [94melif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass right_on or right_index=True[39;49;00m[33m"[39;49;00m)
            [94melif[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass left_on or left_index=True[39;49;00m[33m"[39;49;00m)
            [94melse[39;49;00m:
                [90m# use the common columns[39;49;00m
                left_cols = [96mself[39;49;00m.left.columns
                right_cols = [96mself[39;49;00m.right.columns
                common_cols = left_cols.intersection(right_cols)
                [94mif[39;49;00m [96mlen[39;49;00m(common_cols) == [94m0[39;49;00m:
                    [94mraise[39;49;00m MergeError(
                        [33m"[39;49;00m[33mNo common columns to perform merge on. [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMerge options: left_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mleft_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_index[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_index[33m}[39;49;00m[33m"[39;49;00m
                    )
                [94mif[39;49;00m (
                    [95mnot[39;49;00m left_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                    [95mor[39;49;00m [95mnot[39;49;00m right_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                ):
                    [94mraise[39;49;00m MergeError([33mf[39;49;00m[33m"[39;49;00m[33mData columns not unique: [39;49;00m[33m{[39;49;00m[96mrepr[39;49;00m(common_cols)[33m}[39;49;00m[33m"[39;49;00m)
                [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = common_cols
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mor[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = [96mself[39;49;00m.on
        [94melif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m not both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [95mnot[39;49;00m [96mself[39;49;00m.right_index [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError([33m'[39;49;00m[33mMust pass [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m.[39;49;00m[33m'[39;49;00m)
            n = [96mlen[39;49;00m([96mself[39;49;00m.left_on)
            [94mif[39;49;00m [96mself[39;49;00m.right_index:
                [94mif[39;49;00m [96mlen[39;49;00m([96mself[39;49;00m.left_on) != [96mself[39;49;00m.right.index.nlevels:
>                   [94mraise[39;49;00m [96mValueError[39;49;00m(
                        [33m"[39;49;00m[33mlen(left_on) must equal the number [39;49;00m[33m"[39;49;00m
                        [33m'[39;49;00m[33mof levels in the index of [39;49;00m[33m"[39;49;00m[33mright[39;49;00m[33m"[39;49;00m[33m'[39;49;00m
                    )
[1m[31mE                   ValueError: len(left_on) must equal the number of levels in the index of "right"[0m

[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:1318: ValueError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Val...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 3.66s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:56:00 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 7 items                                                             [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    col_1 col_2
0      0     a
1      1     b
2      2     c
3      3     d
4      4     e
5      5     f
6      6     g
7      7     h
8      8     i
9      9     j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
        train, valid, test = data_splitting.split(
            df_10_rows, train_ratio=[94m0.7[39;49;00m, valid_ratio=[94m0.2[39;49;00m, test_ratio=[94m0.1[39;49;00m, seed=[94m0[39;49;00m
        )
    
>       check = train.join(valid, how=[33m"[39;49;00m[33mleft[39;49;00m[33m"[39;49;00m, on=[[33m"[39;49;00m[33mcol_1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mcol_2[39;49;00m[33m"[39;49;00m], sort=[94mFalse[39;49;00m)

[1m[31mtests/test_data_splitting.py[0m:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8107: in join
    [94mreturn[39;49;00m [96mself[39;49;00m._join_compat(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8132: in _join_compat
    [94mreturn[39;49;00m merge(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:74: in merge
    op = _MergeOperation(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:650: in __init__
    [96mself[39;49;00m._validate_specification()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <pandas.core.reshape.merge._MergeOperation object at 0x7f59f62bc460>

    [94mdef[39;49;00m [92m_validate_specification[39;49;00m([96mself[39;49;00m):
        [94mif[39;49;00m [96mself[39;49;00m.how == [33m"[39;49;00m[33mcross[39;49;00m[33m"[39;49;00m:
            [94mif[39;49;00m (
                [96mself[39;49;00m.left_index
                [95mor[39;49;00m [96mself[39;49;00m.right_index
                [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
            ):
                [94mraise[39;49;00m MergeError(
                    [33m"[39;49;00m[33mCan not pass on, right_on, left_on or set right_index=True or [39;49;00m[33m"[39;49;00m
                    [33m"[39;49;00m[33mleft_index=True[39;49;00m[33m"[39;49;00m
                )
            [94mreturn[39;49;00m
        [90m# Hm, any way to make this logic less complicated??[39;49;00m
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
    
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mand[39;49;00m [96mself[39;49;00m.right_index:
                [96mself[39;49;00m.left_on, [96mself[39;49;00m.right_on = (), ()
            [94melif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass right_on or right_index=True[39;49;00m[33m"[39;49;00m)
            [94melif[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass left_on or left_index=True[39;49;00m[33m"[39;49;00m)
            [94melse[39;49;00m:
                [90m# use the common columns[39;49;00m
                left_cols = [96mself[39;49;00m.left.columns
                right_cols = [96mself[39;49;00m.right.columns
                common_cols = left_cols.intersection(right_cols)
                [94mif[39;49;00m [96mlen[39;49;00m(common_cols) == [94m0[39;49;00m:
                    [94mraise[39;49;00m MergeError(
                        [33m"[39;49;00m[33mNo common columns to perform merge on. [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMerge options: left_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mleft_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_index[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_index[33m}[39;49;00m[33m"[39;49;00m
                    )
                [94mif[39;49;00m (
                    [95mnot[39;49;00m left_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                    [95mor[39;49;00m [95mnot[39;49;00m right_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                ):
                    [94mraise[39;49;00m MergeError([33mf[39;49;00m[33m"[39;49;00m[33mData columns not unique: [39;49;00m[33m{[39;49;00m[96mrepr[39;49;00m(common_cols)[33m}[39;49;00m[33m"[39;49;00m)
                [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = common_cols
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mor[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = [96mself[39;49;00m.on
        [94melif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m not both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [95mnot[39;49;00m [96mself[39;49;00m.right_index [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError([33m'[39;49;00m[33mMust pass [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m.[39;49;00m[33m'[39;49;00m)
            n = [96mlen[39;49;00m([96mself[39;49;00m.left_on)
            [94mif[39;49;00m [96mself[39;49;00m.right_index:
                [94mif[39;49;00m [96mlen[39;49;00m([96mself[39;49;00m.left_on) != [96mself[39;49;00m.right.index.nlevels:
>                   [94mraise[39;49;00m [96mValueError[39;49;00m(
                        [33m"[39;49;00m[33mlen(left_on) must equal the number [39;49;00m[33m"[39;49;00m
                        [33m'[39;49;00m[33mof levels in the index of [39;49;00m[33m"[39;49;00m[33mright[39;49;00m[33m"[39;49;00m[33m'[39;49;00m
                    )
[1m[31mE                   ValueError: len(left_on) must equal the number of levels in the index of "right"[0m

[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:1318: ValueError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Val...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 3.97s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:56:29 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 7 items                                                             [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    col_1 col_2
0      0     a
1      1     b
2      2     c
3      3     d
4      4     e
5      5     f
6      6     g
7      7     h
8      8     i
9      9     j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
        train, valid, test = data_splitting.split(
            df_10_rows, train_ratio=[94m0.7[39;49;00m, valid_ratio=[94m0.2[39;49;00m, test_ratio=[94m0.1[39;49;00m, seed=[94m0[39;49;00m
        )
    
>       check = train.join(valid, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m, on=[[33m"[39;49;00m[33mcol_1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mcol_2[39;49;00m[33m"[39;49;00m], sort=[94mFalse[39;49;00m)

[1m[31mtests/test_data_splitting.py[0m:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8107: in join
    [94mreturn[39;49;00m [96mself[39;49;00m._join_compat(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/frame.py[0m:8132: in _join_compat
    [94mreturn[39;49;00m merge(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:74: in merge
    op = _MergeOperation(
[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:650: in __init__
    [96mself[39;49;00m._validate_specification()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <pandas.core.reshape.merge._MergeOperation object at 0x7ffb8b5859d0>

    [94mdef[39;49;00m [92m_validate_specification[39;49;00m([96mself[39;49;00m):
        [94mif[39;49;00m [96mself[39;49;00m.how == [33m"[39;49;00m[33mcross[39;49;00m[33m"[39;49;00m:
            [94mif[39;49;00m (
                [96mself[39;49;00m.left_index
                [95mor[39;49;00m [96mself[39;49;00m.right_index
                [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
                [95mor[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m
            ):
                [94mraise[39;49;00m MergeError(
                    [33m"[39;49;00m[33mCan not pass on, right_on, left_on or set right_index=True or [39;49;00m[33m"[39;49;00m
                    [33m"[39;49;00m[33mleft_index=True[39;49;00m[33m"[39;49;00m
                )
            [94mreturn[39;49;00m
        [90m# Hm, any way to make this logic less complicated??[39;49;00m
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [94mNone[39;49;00m [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
    
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mand[39;49;00m [96mself[39;49;00m.right_index:
                [96mself[39;49;00m.left_on, [96mself[39;49;00m.right_on = (), ()
            [94melif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass right_on or right_index=True[39;49;00m[33m"[39;49;00m)
            [94melif[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError([33m"[39;49;00m[33mMust pass left_on or left_index=True[39;49;00m[33m"[39;49;00m)
            [94melse[39;49;00m:
                [90m# use the common columns[39;49;00m
                left_cols = [96mself[39;49;00m.left.columns
                right_cols = [96mself[39;49;00m.right.columns
                common_cols = left_cols.intersection(right_cols)
                [94mif[39;49;00m [96mlen[39;49;00m(common_cols) == [94m0[39;49;00m:
                    [94mraise[39;49;00m MergeError(
                        [33m"[39;49;00m[33mNo common columns to perform merge on. [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMerge options: left_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_on=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_on[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mleft_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.left_index[33m}[39;49;00m[33m, [39;49;00m[33m"[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mright_index=[39;49;00m[33m{[39;49;00m[96mself[39;49;00m.right_index[33m}[39;49;00m[33m"[39;49;00m
                    )
                [94mif[39;49;00m (
                    [95mnot[39;49;00m left_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                    [95mor[39;49;00m [95mnot[39;49;00m right_cols.join(common_cols, how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m).is_unique
                ):
                    [94mraise[39;49;00m MergeError([33mf[39;49;00m[33m"[39;49;00m[33mData columns not unique: [39;49;00m[33m{[39;49;00m[96mrepr[39;49;00m(common_cols)[33m}[39;49;00m[33m"[39;49;00m)
                [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = common_cols
        [94melif[39;49;00m [96mself[39;49;00m.on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m [95mor[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [96mself[39;49;00m.left_index [95mor[39;49;00m [96mself[39;49;00m.right_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mon[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m [39;49;00m[33m'[39;49;00m
                    [33m'[39;49;00m[33mand [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m, not a combination of both.[39;49;00m[33m'[39;49;00m
                )
            [96mself[39;49;00m.left_on = [96mself[39;49;00m.right_on = [96mself[39;49;00m.on
        [94melif[39;49;00m [96mself[39;49;00m.left_on [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:
            [94mif[39;49;00m [96mself[39;49;00m.left_index:
                [94mraise[39;49;00m MergeError(
                    [33m'[39;49;00m[33mCan only pass argument [39;49;00m[33m"[39;49;00m[33mleft_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mleft_index[39;49;00m[33m"[39;49;00m[33m not both.[39;49;00m[33m'[39;49;00m
                )
            [94mif[39;49;00m [95mnot[39;49;00m [96mself[39;49;00m.right_index [95mand[39;49;00m [96mself[39;49;00m.right_on [95mis[39;49;00m [94mNone[39;49;00m:
                [94mraise[39;49;00m MergeError([33m'[39;49;00m[33mMust pass [39;49;00m[33m"[39;49;00m[33mright_on[39;49;00m[33m"[39;49;00m[33m OR [39;49;00m[33m"[39;49;00m[33mright_index[39;49;00m[33m"[39;49;00m[33m.[39;49;00m[33m'[39;49;00m)
            n = [96mlen[39;49;00m([96mself[39;49;00m.left_on)
            [94mif[39;49;00m [96mself[39;49;00m.right_index:
                [94mif[39;49;00m [96mlen[39;49;00m([96mself[39;49;00m.left_on) != [96mself[39;49;00m.right.index.nlevels:
>                   [94mraise[39;49;00m [96mValueError[39;49;00m(
                        [33m"[39;49;00m[33mlen(left_on) must equal the number [39;49;00m[33m"[39;49;00m
                        [33m'[39;49;00m[33mof levels in the index of [39;49;00m[33m"[39;49;00m[33mright[39;49;00m[33m"[39;49;00m[33m'[39;49;00m
                    )
[1m[31mE                   ValueError: len(left_on) must equal the number of levels in the index of "right"[0m

[1m[31m../local/lib/python3.9/site-packages/pandas/core/reshape/merge.py[0m:1318: ValueError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Val...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 4.10s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:57:42 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [31mFAILED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

=================================== FAILURES ===================================
[31m[1m______________________ test_data_splitting_train_vs_valid ______________________[0m

df_10_rows =    col_1 col_2
0      0     a
1      1     b
2      2     c
3      3     d
4      4     e
5      5     f
6      6     g
7      7     h
8      8     i
9      9     j

    [94mdef[39;49;00m [92mtest_data_splitting_train_vs_valid[39;49;00m(df_10_rows):
    
        train, valid, test = data_splitting.split(
            df_10_rows, train_ratio=[94m0.7[39;49;00m, valid_ratio=[94m0.2[39;49;00m, test_ratio=[94m0.1[39;49;00m, seed=[94m0[39;49;00m
        )
    
>       check = train.join(
            valid,
            how=[33m"[39;49;00m[33minner[39;49;00m[33m"[39;49;00m,
            right_on=[[33m"[39;49;00m[33mcol_1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mcol_2[39;49;00m[33m"[39;49;00m],
            left_on=[[33m"[39;49;00m[33mcol_1[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mcol_2[39;49;00m[33m"[39;49;00m],
            sort=[94mFalse[39;49;00m
            )
[1m[31mE       TypeError: join() got an unexpected keyword argument 'right_on'[0m

[1m[31mtests/test_data_splitting.py[0m:49: TypeError
=========================== short test summary info ============================
FAILED tests/test_data_splitting.py::test_data_splitting_train_vs_valid - Typ...
[31m========================= [31m[1m1 failed[0m, [32m6 passed[0m[31m in 3.35s[0m[31m ==========================[0m
Thu 15 Apr 2021 08:58:00 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 7 items                                                             [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid Empty DataFrame
Columns: [col_1, col_2]
Index: []
[32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m7 passed[0m[32m in 3.79s[0m[32m ===============================[0m
Thu 15 Apr 2021 08:59:54 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 1 item / 1 error                                                    [0m[1mcollected 3 items / 1 error / 2 selected                                       [0m

==================================== ERRORS ====================================
[31m[1m________________ ERROR collecting tests/test_data_splitting.py _________________[0m
[31m../local/lib/python3.9/site-packages/_pytest/python.py:578: in _importtestmodule
    mod = import_path(self.fspath, mode=importmode)
../local/lib/python3.9/site-packages/_pytest/pathlib.py:531: in import_path
    importlib.import_module(module_name)
../local/lib/python3.9/importlib/__init__.py:127: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
<frozen importlib._bootstrap>:1030: in _gcd_import
    ???
<frozen importlib._bootstrap>:1007: in _find_and_load
    ???
<frozen importlib._bootstrap>:986: in _find_and_load_unlocked
    ???
<frozen importlib._bootstrap>:680: in _load_unlocked
    ???
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:161: in exec_module
    source_stat, co = _rewrite_test(fn, self.config)
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:354: in _rewrite_test
    tree = ast.parse(source, filename=fn_)
../local/lib/python3.9/ast.py:50: in parse
    return compile(source, filename, mode, flags,
E     File "/usr/app/tests/test_data_splitting.py", line 57
E       assert check.empty
E                         ^
E   IndentationError: unindent does not match any outer indentation level[0m
=========================== short test summary info ============================
ERROR tests/test_data_splitting.py
!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
[31m=============================== [31m[1m1 error[0m[31m in 3.64s[0m[31m ===============================[0m
Thu 15 Apr 2021 09:01:49 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 1 item / 1 error                                                    [0m[1mcollecting 3 items / 1 error / 2 selected                                      [0m[1mcollected 3 items / 1 error / 2 selected                                       [0m

==================================== ERRORS ====================================
[31m[1m________________ ERROR collecting tests/test_data_splitting.py _________________[0m
[31m../local/lib/python3.9/site-packages/_pytest/python.py:578: in _importtestmodule
    mod = import_path(self.fspath, mode=importmode)
../local/lib/python3.9/site-packages/_pytest/pathlib.py:531: in import_path
    importlib.import_module(module_name)
../local/lib/python3.9/importlib/__init__.py:127: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
<frozen importlib._bootstrap>:1030: in _gcd_import
    ???
<frozen importlib._bootstrap>:1007: in _find_and_load
    ???
<frozen importlib._bootstrap>:986: in _find_and_load_unlocked
    ???
<frozen importlib._bootstrap>:680: in _load_unlocked
    ???
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:161: in exec_module
    source_stat, co = _rewrite_test(fn, self.config)
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:354: in _rewrite_test
    tree = ast.parse(source, filename=fn_)
../local/lib/python3.9/ast.py:50: in parse
    return compile(source, filename, mode, flags,
E     File "/usr/app/tests/test_data_splitting.py", line 57
E       assert df_check.empty
E                            ^
E   IndentationError: unindent does not match any outer indentation level[0m
=========================== short test summary info ============================
ERROR tests/test_data_splitting.py
!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
[31m=============================== [31m[1m1 error[0m[31m in 3.41s[0m[31m ===============================[0m
Thu 15 Apr 2021 09:02:50 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 3 items / 1 error / 2 selected                                      [0m[1mcollected 3 items / 1 error / 2 selected                                       [0m

==================================== ERRORS ====================================
[31m[1m________________ ERROR collecting tests/test_data_splitting.py _________________[0m
[31m../local/lib/python3.9/site-packages/_pytest/python.py:578: in _importtestmodule
    mod = import_path(self.fspath, mode=importmode)
../local/lib/python3.9/site-packages/_pytest/pathlib.py:531: in import_path
    importlib.import_module(module_name)
../local/lib/python3.9/importlib/__init__.py:127: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
<frozen importlib._bootstrap>:1030: in _gcd_import
    ???
<frozen importlib._bootstrap>:1007: in _find_and_load
    ???
<frozen importlib._bootstrap>:986: in _find_and_load_unlocked
    ???
<frozen importlib._bootstrap>:680: in _load_unlocked
    ???
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:161: in exec_module
    source_stat, co = _rewrite_test(fn, self.config)
../local/lib/python3.9/site-packages/_pytest/assertion/rewrite.py:354: in _rewrite_test
    tree = ast.parse(source, filename=fn_)
../local/lib/python3.9/ast.py:50: in parse
    return compile(source, filename, mode, flags,
E     File "/usr/app/tests/test_data_splitting.py", line 57
E       assert df_check.empty
E                            ^
E   IndentationError: unindent does not match any outer indentation level[0m
=========================== short test summary info ============================
ERROR tests/test_data_splitting.py
!!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
[31m=============================== [31m[1m1 error[0m[31m in 2.22s[0m[31m ===============================[0m
Thu 15 Apr 2021 09:04:13 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollecting 7 items                                                             [0m[1mcollected 7 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m7 passed[0m[32m in 2.45s[0m[32m ===============================[0m
Thu 15 Apr 2021 09:05:07 PM UTC
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.9.2, pytest-6.2.2, py-1.10.0, pluggy-0.13.1 -- /usr/local/bin/python
cachedir: .pytest_cache
rootdir: /usr/app
plugins: anyio-2.2.0
[1mcollecting ... [0m[1mcollecting 1 item                                                              [0m[1mcollected 9 items                                                              [0m

tests/test_data_sourcing.py::test_data_sourcing_get      bill_length_mm  ...    species
0              39.1  ...     Adelie
1              39.5  ...     Adelie
2              40.3  ...     Adelie
3               NaN  ...     Adelie
4              36.7  ...     Adelie
..              ...  ...        ...
339            55.8  ...  Chinstrap
340            43.5  ...  Chinstrap
341            49.6  ...  Chinstrap
342            50.8  ...  Chinstrap
343            50.2  ...  Chinstrap

[344 rows x 6 columns]
[32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_test_ratio [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_valid [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_train_vs_test [32mPASSED[0m
tests/test_data_splitting.py::test_data_splitting_valid_vs_test [32mPASSED[0m
tests/test_feature_engineering.py::test_numerical_missing_imputation_twofeatures [32mPASSED[0m
tests/test_feature_engineering.py::test_one_hot_encoding [32mPASSED[0m

[32m============================== [32m[1m9 passed[0m[32m in 2.08s[0m[32m ===============================[0m
